<!DOCTYPE html>
<html>

<head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
<meta charset="utf-8">




<link rel="stylesheet" href="/css/main.css" integrity="">

<link href="https://fonts.googleapis.com/css2?family=Libre+Baskerville&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Barlow&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Playfair+Display&display=swap" rel="stylesheet">
    <title>
Solução OBI 2018 Baldes &ndash; gbrls - Gabriel Schneider&#39;s website

    </title>
</head>

<body>
    

    <div class="main-content">
        
<div class="single-content">
    <h1>Solução OBI 2018 Baldes</h1>

    <p><a href="https://olimpiada.ic.unicamp.br/pratique/pu/2018/f3/baldes/">Enunciado</a><br>
Na minha primeira leitura, vi que esta é uma questão clássica de segtree. Um vetor de tamanho \(10^5\) e \(10^5\) queries dentro desse intervalo. Iremos fazer uma segtree para o mínimo num intervalo e outra para o máximo, sendo a resposta da query em um intervalo o max-min. Para simplificar isso, podemos guardar as duas árvores apenas em um vetor de pairs.</p>
<p>Porém após implementar a primeira solução e não funcionar fiz uma segunda leitura e percebi que o max e o min não podem estar no mesmo balde (na mesma posição no vetor). Então troquei o pair por uma struct, para guardar de qual balde o max e o min vieram. Quando o min e o max estiverem no mesmo balde temos uma certeza, um dos dois faz parte da solução. Nesse caso podemos testar, o query sem o min, mas com o max e o query sem o max, mas com o min.</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 19
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 20
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 21
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 22
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 23
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 24
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 25
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 26
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 27
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 28
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 29
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 30
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 31
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 32
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 33
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 34
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 35
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 36
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 37
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 38
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 39
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 40
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 41
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 42
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 43
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 44
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 45
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 46
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 47
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 48
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 49
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 50
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 51
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 52
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 53
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 54
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 55
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 56
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 57
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 58
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 59
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 60
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 61
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 62
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 63
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 64
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 65
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 66
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 67
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 68
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 69
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 70
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 71
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 72
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 73
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 74
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 75
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 76
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 77
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 78
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 79
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 80
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 81
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 82
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 83
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 84
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 85
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 86
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 87
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 88
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 89
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 90
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 91
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 92
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 93
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 94
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 95
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 96
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 97
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 98
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 99
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">100
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">101
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">102
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">103
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">104
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">105
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">106
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">107
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">108
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">109
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">110
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">111
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">112
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">113
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">114
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">115
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">116
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">117
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">118
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">119
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">120
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">121
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">122
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cpp" data-lang="cpp"><span style="color:#888;font-style:italic">#include</span> <span style="color:#888;font-style:italic">&lt;bits/stdc++.h&gt;</span><span style="color:#888;font-style:italic">
</span><span style="color:#888;font-style:italic"></span><span style="color:#00f">typedef</span> <span style="color:#00f">struct</span> <span style="color:#000">ii</span> {
    <span style="color:#00f">int</span> <span style="color:#000">first</span>;
    <span style="color:#00f">int</span> <span style="color:#000">second</span>;
    <span style="color:#00f">int</span> <span style="color:#000">i</span>;
    <span style="color:#00f">int</span> <span style="color:#000">j</span>;
} <span style="color:#000">ii</span>;
<span style="color:#00f">using</span> <span style="color:#00f">namespace</span> <span style="color:#000">std</span>;

<span style="color:#00f">const</span> <span style="color:#00f">int</span> <span style="color:#000">MAX</span> = <span style="color:#3af">5e5</span>+<span style="color:#3af">50</span>;
<span style="color:#00f">const</span> <span style="color:#00f">int</span> <span style="color:#000">inf</span> = <span style="color:#3af">0x3f3f3f3f</span>;

<span style="color:#000">ii</span> <span style="color:#000">tree</span>[<span style="color:#000">MAX</span>]={};
<span style="color:#00f">int</span> <span style="color:#000">arr</span>[<span style="color:#000">MAX</span>];

<span style="color:#000">ii</span> <span style="color:#000">merge</span>(<span style="color:#000">ii</span> <span style="color:#000">a</span>, <span style="color:#000">ii</span> <span style="color:#000">b</span>) {

    <span style="color:#000">ii</span> <span style="color:#000">c</span> = {<span style="color:#000">min</span>(<span style="color:#000">a</span>.<span style="color:#000">first</span>,<span style="color:#000">b</span>.<span style="color:#000">first</span>),<span style="color:#000">max</span>(<span style="color:#000">a</span>.<span style="color:#000">second</span>,<span style="color:#000">b</span>.<span style="color:#000">second</span>),-<span style="color:#3af">1</span>,-<span style="color:#3af">2</span>};

    <span style="color:#00f">if</span>(<span style="color:#000">c</span>.<span style="color:#000">first</span>==<span style="color:#000">a</span>.<span style="color:#000">first</span>) <span style="color:#000">c</span>.<span style="color:#000">i</span>=<span style="color:#000">a</span>.<span style="color:#000">i</span>;
    <span style="color:#00f">else</span> <span style="color:#000">c</span>.<span style="color:#000">i</span>=<span style="color:#000">b</span>.<span style="color:#000">i</span>;

    <span style="color:#00f">if</span>(<span style="color:#000">c</span>.<span style="color:#000">second</span>==<span style="color:#000">a</span>.<span style="color:#000">second</span>) <span style="color:#000">c</span>.<span style="color:#000">j</span>=<span style="color:#000">a</span>.<span style="color:#000">j</span>;
    <span style="color:#00f">else</span> <span style="color:#000">c</span>.<span style="color:#000">j</span>=<span style="color:#000">b</span>.<span style="color:#000">j</span>;

    <span style="color:#00f">return</span> <span style="color:#000">c</span>;
}

<span style="color:#00f">void</span> <span style="color:#000">build</span>(<span style="color:#00f">int</span> <span style="color:#000">pos</span>, <span style="color:#00f">int</span> <span style="color:#000">i</span>, <span style="color:#00f">int</span> <span style="color:#000">j</span>) {
    <span style="color:#00f">if</span>(<span style="color:#000">i</span>==<span style="color:#000">j</span>) {
        <span style="color:#000">tree</span>[<span style="color:#000">pos</span>]={<span style="color:#000">arr</span>[<span style="color:#000">i</span>],<span style="color:#000">arr</span>[<span style="color:#000">i</span>],<span style="color:#000">i</span>,<span style="color:#000">i</span>};
        <span style="color:#00f">if</span>(<span style="color:#000">arr</span>[<span style="color:#000">i</span>]==<span style="color:#3af">0</span>) {
            <span style="color:#000">tree</span>[<span style="color:#000">pos</span>]={<span style="color:#000">inf</span>,-<span style="color:#000">inf</span>,-<span style="color:#3af">1</span>,-<span style="color:#3af">2</span>};
        }
    } <span style="color:#00f">else</span> {
        <span style="color:#000">build</span>(<span style="color:#3af">2</span>*<span style="color:#000">pos</span>,<span style="color:#000">i</span>,(<span style="color:#000">i</span>+<span style="color:#000">j</span>)/<span style="color:#3af">2</span>);
        <span style="color:#000">build</span>(<span style="color:#3af">2</span>*<span style="color:#000">pos</span>+<span style="color:#3af">1</span>,(<span style="color:#000">i</span>+<span style="color:#000">j</span>)/<span style="color:#3af">2</span>+<span style="color:#3af">1</span>,<span style="color:#000">j</span>);

        <span style="color:#000">tree</span>[<span style="color:#000">pos</span>]=<span style="color:#000">merge</span>(<span style="color:#000">tree</span>[<span style="color:#3af">2</span>*<span style="color:#000">pos</span>],<span style="color:#000">tree</span>[<span style="color:#3af">2</span>*<span style="color:#000">pos</span>+<span style="color:#3af">1</span>]);
    }
}

<span style="color:#00f">void</span> <span style="color:#000">update</span>(<span style="color:#00f">int</span> <span style="color:#000">pos</span>, <span style="color:#00f">int</span> <span style="color:#000">i</span>, <span style="color:#00f">int</span> <span style="color:#000">j</span>, <span style="color:#00f">int</span> <span style="color:#000">target</span>, <span style="color:#000">ii</span> <span style="color:#000">val</span>) {
    <span style="color:#00f">if</span>(<span style="color:#000">i</span>==<span style="color:#000">j</span>) {
        <span style="color:#00f">if</span>(<span style="color:#000">tree</span>[<span style="color:#000">pos</span>].<span style="color:#000">first</span>!=<span style="color:#3af">0</span>&amp;&amp;<span style="color:#000">tree</span>[<span style="color:#000">pos</span>].<span style="color:#000">second</span>!=<span style="color:#3af">0</span>) {
            <span style="color:#000">tree</span>[<span style="color:#000">pos</span>]=<span style="color:#000">merge</span>(<span style="color:#000">tree</span>[<span style="color:#000">pos</span>],<span style="color:#000">val</span>);
        } <span style="color:#00f">else</span> {
            <span style="color:#000">tree</span>[<span style="color:#000">pos</span>]=<span style="color:#000">val</span>; 
        }
    } <span style="color:#00f">else</span> {
        <span style="color:#00f">if</span>(<span style="color:#000">target</span> &lt;= (<span style="color:#000">i</span>+<span style="color:#000">j</span>)/<span style="color:#3af">2</span>) <span style="color:#000">update</span>(<span style="color:#3af">2</span>*<span style="color:#000">pos</span>,<span style="color:#000">i</span>,(<span style="color:#000">i</span>+<span style="color:#000">j</span>)/<span style="color:#3af">2</span>,<span style="color:#000">target</span>,<span style="color:#000">val</span>);
        <span style="color:#00f">else</span> <span style="color:#000">update</span>(<span style="color:#3af">2</span>*<span style="color:#000">pos</span>+<span style="color:#3af">1</span>,(<span style="color:#000">i</span>+<span style="color:#000">j</span>)/<span style="color:#3af">2</span>+<span style="color:#3af">1</span>,<span style="color:#000">j</span>,<span style="color:#000">target</span>,<span style="color:#000">val</span>);

        <span style="color:#000">tree</span>[<span style="color:#000">pos</span>]=<span style="color:#000">merge</span>(<span style="color:#000">tree</span>[<span style="color:#3af">2</span>*<span style="color:#000">pos</span>],<span style="color:#000">tree</span>[<span style="color:#3af">2</span>*<span style="color:#000">pos</span>+<span style="color:#3af">1</span>]);
    }
}

<span style="color:#00f">void</span> <span style="color:#000">force_update</span>(<span style="color:#00f">int</span> <span style="color:#000">pos</span>, <span style="color:#00f">int</span> <span style="color:#000">i</span>, <span style="color:#00f">int</span> <span style="color:#000">j</span>, <span style="color:#00f">int</span> <span style="color:#000">target</span>, <span style="color:#000">ii</span> <span style="color:#000">val</span>) {
    <span style="color:#00f">if</span>(<span style="color:#000">i</span>==<span style="color:#000">j</span>) {
        <span style="color:#000">tree</span>[<span style="color:#000">pos</span>]=<span style="color:#000">val</span>; 
    } <span style="color:#00f">else</span> {
        <span style="color:#00f">if</span>(<span style="color:#000">target</span> &lt;= (<span style="color:#000">i</span>+<span style="color:#000">j</span>)/<span style="color:#3af">2</span>) <span style="color:#000">force_update</span>(<span style="color:#3af">2</span>*<span style="color:#000">pos</span>,<span style="color:#000">i</span>,(<span style="color:#000">i</span>+<span style="color:#000">j</span>)/<span style="color:#3af">2</span>,<span style="color:#000">target</span>,<span style="color:#000">val</span>);
        <span style="color:#00f">else</span> <span style="color:#000">force_update</span>(<span style="color:#3af">2</span>*<span style="color:#000">pos</span>+<span style="color:#3af">1</span>,(<span style="color:#000">i</span>+<span style="color:#000">j</span>)/<span style="color:#3af">2</span>+<span style="color:#3af">1</span>,<span style="color:#000">j</span>,<span style="color:#000">target</span>,<span style="color:#000">val</span>);
        <span style="color:#000">tree</span>[<span style="color:#000">pos</span>]=<span style="color:#000">merge</span>(<span style="color:#000">tree</span>[<span style="color:#3af">2</span>*<span style="color:#000">pos</span>],<span style="color:#000">tree</span>[<span style="color:#3af">2</span>*<span style="color:#000">pos</span>+<span style="color:#3af">1</span>]);
    }
}

<span style="color:#000">ii</span> <span style="color:#000">query</span>(<span style="color:#00f">int</span> <span style="color:#000">pos</span>, <span style="color:#00f">int</span> <span style="color:#000">i</span>, <span style="color:#00f">int</span> <span style="color:#000">j</span>, <span style="color:#00f">int</span> <span style="color:#000">a</span>, <span style="color:#00f">int</span> <span style="color:#000">b</span>) {
    <span style="color:#00f">if</span>(<span style="color:#000">i</span>&gt;<span style="color:#000">b</span>||<span style="color:#000">j</span>&lt;<span style="color:#000">a</span>) {
        <span style="color:#00f">return</span> {<span style="color:#000">inf</span>,-<span style="color:#000">inf</span>, -<span style="color:#3af">1</span>, -<span style="color:#3af">2</span>};
    } <span style="color:#00f">else</span> <span style="color:#00f">if</span>(<span style="color:#000">i</span>&gt;=<span style="color:#000">a</span>&amp;&amp;<span style="color:#000">j</span>&lt;=<span style="color:#000">b</span>) {
        <span style="color:#00f">return</span> <span style="color:#000">tree</span>[<span style="color:#000">pos</span>];
    } <span style="color:#00f">else</span> {
        <span style="color:#00f">return</span> <span style="color:#000">merge</span>(<span style="color:#000">query</span>(<span style="color:#3af">2</span>*<span style="color:#000">pos</span>,<span style="color:#000">i</span>,(<span style="color:#000">i</span>+<span style="color:#000">j</span>)/<span style="color:#3af">2</span>,<span style="color:#000">a</span>,<span style="color:#000">b</span>),<span style="color:#000">query</span>(<span style="color:#3af">2</span>*<span style="color:#000">pos</span>+<span style="color:#3af">1</span>,(<span style="color:#000">i</span>+<span style="color:#000">j</span>)/<span style="color:#3af">2</span>+<span style="color:#3af">1</span>,<span style="color:#000">j</span>,<span style="color:#000">a</span>,<span style="color:#000">b</span>));
    }
}

<span style="color:#00f">int</span> <span style="color:#000">main</span>() {

    <span style="color:#00f">int</span> <span style="color:#000">n</span>,<span style="color:#000">m</span>;
    <span style="color:#000">scanf</span>(<span style="color:#5a2">&#34;%d%d&#34;</span>,&amp;<span style="color:#000">n</span>,&amp;<span style="color:#000">m</span>);

    <span style="color:#00f">for</span>(<span style="color:#00f">int</span> <span style="color:#000">i</span>=<span style="color:#3af">0</span>;<span style="color:#000">i</span>&lt;<span style="color:#000">n</span>;<span style="color:#000">i</span>++) <span style="color:#000">scanf</span>(<span style="color:#5a2">&#34;%d&#34;</span>,&amp;<span style="color:#000">arr</span>[<span style="color:#000">i</span>]);

    <span style="color:#000">build</span>(<span style="color:#3af">1</span>,<span style="color:#3af">0</span>,<span style="color:#000">n</span>);

    <span style="color:#00f">for</span>(<span style="color:#00f">int</span> <span style="color:#000">i</span>=<span style="color:#3af">0</span>;<span style="color:#000">i</span>&lt;<span style="color:#000">m</span>;<span style="color:#000">i</span>++) {
        <span style="color:#00f">int</span> <span style="color:#000">op</span>;
        <span style="color:#000">scanf</span>(<span style="color:#5a2">&#34;%d&#34;</span>,&amp;<span style="color:#000">op</span>);

        <span style="color:#00f">if</span>(<span style="color:#000">op</span>==<span style="color:#3af">1</span>) {
            <span style="color:#00f">int</span> <span style="color:#000">w</span>,<span style="color:#000">p</span>;
            <span style="color:#000">scanf</span>(<span style="color:#5a2">&#34;%d%d&#34;</span>,&amp;<span style="color:#000">w</span>,&amp;<span style="color:#000">p</span>);
            --<span style="color:#000">p</span>;
            <span style="color:#000">update</span>(<span style="color:#3af">1</span>,<span style="color:#3af">0</span>,<span style="color:#000">n</span>,<span style="color:#000">p</span>,{<span style="color:#000">w</span>,<span style="color:#000">w</span>,<span style="color:#000">p</span>,<span style="color:#000">p</span>});
        } <span style="color:#00f">else</span> {
            <span style="color:#00f">int</span> <span style="color:#000">a</span>,<span style="color:#000">b</span>;
            <span style="color:#000">scanf</span>(<span style="color:#5a2">&#34;%d%d&#34;</span>,&amp;<span style="color:#000">a</span>,&amp;<span style="color:#000">b</span>);
            --<span style="color:#000">a</span>,--<span style="color:#000">b</span>;
            <span style="color:#000">ii</span> <span style="color:#000">p</span> = <span style="color:#000">query</span>(<span style="color:#3af">1</span>,<span style="color:#3af">0</span>,<span style="color:#000">n</span>,<span style="color:#000">a</span>,<span style="color:#000">b</span>);

            <span style="color:#00f">if</span>(<span style="color:#000">p</span>.<span style="color:#000">i</span>==<span style="color:#000">p</span>.<span style="color:#000">j</span>) {
                <span style="color:#000">ii</span> <span style="color:#000">tmp</span> = <span style="color:#000">p</span>;
                <span style="color:#00f">int</span> <span style="color:#000">ans</span>=<span style="color:#3af">0</span>;
                <span style="color:#000">force_update</span>(<span style="color:#3af">1</span>,<span style="color:#3af">0</span>,<span style="color:#000">n</span>,<span style="color:#000">p</span>.<span style="color:#000">i</span>,{<span style="color:#000">p</span>.<span style="color:#000">first</span>,-<span style="color:#000">inf</span>,<span style="color:#000">p</span>.<span style="color:#000">i</span>,<span style="color:#000">p</span>.<span style="color:#000">j</span>});
                <span style="color:#000">ii</span> <span style="color:#000">A</span> = <span style="color:#000">query</span>(<span style="color:#3af">1</span>,<span style="color:#3af">0</span>,<span style="color:#000">n</span>,<span style="color:#000">a</span>,<span style="color:#000">b</span>);
                <span style="color:#000">force_update</span>(<span style="color:#3af">1</span>,<span style="color:#3af">0</span>,<span style="color:#000">n</span>,<span style="color:#000">p</span>.<span style="color:#000">i</span>,{<span style="color:#000">inf</span>,<span style="color:#000">p</span>.<span style="color:#000">second</span>,<span style="color:#000">p</span>.<span style="color:#000">i</span>,<span style="color:#000">p</span>.<span style="color:#000">j</span>});
                <span style="color:#000">ii</span> <span style="color:#000">B</span> = <span style="color:#000">query</span>(<span style="color:#3af">1</span>,<span style="color:#3af">0</span>,<span style="color:#000">n</span>,<span style="color:#000">a</span>,<span style="color:#000">b</span>);

                <span style="color:#000">ans</span>=<span style="color:#000">max</span>(<span style="color:#000">A</span>.<span style="color:#000">second</span>-<span style="color:#000">A</span>.<span style="color:#000">first</span>,<span style="color:#000">B</span>.<span style="color:#000">second</span>-<span style="color:#000">B</span>.<span style="color:#000">first</span>);
                <span style="color:#000">printf</span>(<span style="color:#5a2">&#34;%d</span><span style="color:#5a2">\n</span><span style="color:#5a2">&#34;</span>,<span style="color:#000">ans</span>);

                <span style="color:#000">update</span>(<span style="color:#3af">1</span>,<span style="color:#3af">0</span>,<span style="color:#000">n</span>,<span style="color:#000">p</span>.<span style="color:#000">i</span>,<span style="color:#000">p</span>);
            } <span style="color:#00f">else</span> {
                <span style="color:#000">printf</span>(<span style="color:#5a2">&#34;%d</span><span style="color:#5a2">\n</span><span style="color:#5a2">&#34;</span>,<span style="color:#000">p</span>.<span style="color:#000">second</span>-<span style="color:#000">p</span>.<span style="color:#000">first</span>);
            }
        }
        
    }

    <span style="color:#00f">return</span> <span style="color:#3af">0</span>;
}
</code></pre></td></tr></table>
</div>
</div>
</div>

    </div>
    
    
    <footer class="footer">
    <ul>
        <li>Gabriel Schneider</li>
        <li><a href="mailto:gas6@cin.ufpe.br">gas6@cin.ufpe.br</a></li>
    </ul>
</footer>
    

</body>

</html>